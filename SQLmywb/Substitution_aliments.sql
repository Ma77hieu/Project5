-- MySQL Script generated by MySQL Workbench
-- Fri Nov 27 10:42:38 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

-- SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
-- SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
-- SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema substitution_aliments
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema substitution_aliments
-- -----------------------------------------------------
-- DROP DATABASE IF EXISTS substitution_aliments;
-- CREATE DATABASE `substitution_aliments` CHARACTER SET 'utf8mb4';
-- USE substitution_aliments;

-- -----------------------------------------------------
-- Table `categories`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `categories` ;

CREATE TABLE IF NOT EXISTS `categories` (
  `id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, 
  `name` VARCHAR(70) NULL);


-- -----------------------------------------------------
-- Table `aliments`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `aliments`;

CREATE TABLE IF NOT EXISTS `aliments` (
  `id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
  `name` VARCHAR(500) NULL,
  `nutrition_grade` CHAR(1) NULL,
  `stores` VARCHAR(255) NULL,
  `url` VARCHAR(255) NULL,
  `categories_id` INTEGER NOT NULL,
  FOREIGN KEY (`categories_id`)
    REFERENCES `categories` (`id`)
     ON DELETE NO ACTION
     ON UPDATE NO ACTION
  );

CREATE INDEX fk_aliments_categories_idx ON aliments(categories_id) ;

  -- CONSTRAINT `fk_aliments_categories`

  -- -- -----------------------------------------------------
-- -- Table `substituts`
-- -- -----------------------------------------------------
DROP TABLE IF EXISTS `substituts` ;

CREATE TABLE IF NOT EXISTS `substituts` (
  `aliments_id` INTEGER NOT NULL,
  `substitut_id` INTEGER NOT NULL,
  PRIMARY KEY (`aliments_id`, `substitut_id`),
  CONSTRAINT `fk_aliments_has_aliments_aliments1`
    FOREIGN KEY (`aliments_id`)
    REFERENCES `aliments` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_aliments_has_aliments_aliments2`
    FOREIGN KEY (`substitut_id`)
    REFERENCES `aliments` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE INDEX `fk_aliments_has_aliments_aliments2_idx` ON `substituts`(`substitut_id`);
CREATE INDEX `fk_aliments_has_aliments_aliments1_idx` ON `substituts`(`aliments_id`);


-- -- -----------------------------------------------------
-- -- Table `substituts`
-- -- -----------------------------------------------------
-- DROP TABLE IF EXISTS `substituts` ;

-- CREATE TABLE IF NOT EXISTS `substituts` (
--   `aliments_id` INTEGER PRIMARY KEY NOT NULL,
--   `substitut_id` INTEGER PRIMARY KEY NOT NULL,
--   CONSTRAINT `fk_aliments_has_aliments_aliments1`
--     FOREIGN KEY (`aliments_id`)
--     REFERENCES `aliments` (`id`)
--     ON DELETE NO ACTION
--     ON UPDATE NO ACTION,
--   CONSTRAINT `fk_aliments_has_aliments_aliments2`
--     FOREIGN KEY (`substitut_id`)
--     REFERENCES `aliments` (`id`)
--     ON DELETE NO ACTION
--     ON UPDATE NO ACTION);

-- CREATE INDEX `fk_aliments_has_aliments_aliments2_idx` ON `substituts`(`substitut_id`);
-- CREATE INDEX `fk_aliments_has_aliments_aliments1_idx` ON `substituts`(`aliments_id`);



-- -- SET SQL_MODE=@OLD_SQL_MODE;
-- -- SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
-- -- SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
